{% extends 'base.html' %} {% block title %}Eventos - SGEA{% endblock %} {% block content %}
<div class="container mt-4">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col">
      <h1 class="display-5"><i class="bi bi-calendar-event"></i> Eventos Acadêmicos</h1>
      <p class="lead text-muted">Encontre e participe dos melhores eventos acadêmicos</p>
    </div>
  </div>

  <!-- Filtros de Busca -->
  <div class="card mb-4">
    <div class="card-body">
      <form method="get" class="row g-3">
        <div class="col-md-5">{{ search_form.busca }}</div>
        <div class="col-md-3">{{ search_form.tipo_evento }}</div>
        <div class="col-md-2 d-flex align-items-center">
          <div class="form-check">
            {{ search_form.apenas_com_vagas }}
            <label class="form-check-label" for="{{ search_form.apenas_com_vagas.id_for_label }}"> Apenas com vagas </label>
          </div>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary w-100"><i class="bi bi-search"></i> Buscar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Listagem de Eventos -->
  {% if events %}
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mb-4">
    {% for event in events %}
    <div class="col">
      <div class="card h-100">
        {% if event.imagem %}
        <img src="{{ event.imagem.url }}" class="card-img-top" alt="{{ event.titulo }}" style="height: 200px; object-fit: cover" />
        {% else %}
        <div class="card-img-top bg-primary d-flex align-items-center justify-content-center" style="height: 200px">
          <i class="bi bi-calendar-event text-white" style="font-size: 4rem"></i>
        </div>
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ event.titulo }}</h5>
          <p class="text-muted small mb-2">
            <span class="badge bg-secondary">{{ event.get_tipo_evento_display }}</span>
          </p>
          <p class="card-text flex-grow-1">{{ event.descricao|truncatewords:20 }}</p>
          <div class="mb-2">
            <small class="text-muted"> <i class="bi bi-calendar"></i> {{ event.data_inicio|date:"d/m/Y" }} {% if event.data_inicio != event.data_fim %} até {{ event.data_fim|date:"d/m/Y" }} {% endif %} </small>
          </div>
          <div class="mb-2">
            <small class="text-muted"> <i class="bi bi-geo-alt"></i> {{ event.local }} </small>
          </div>
          <div class="mb-3">
            <small class="text-muted">
              <i class="bi bi-people"></i>
              {% if event.vagas_disponiveis > 0 %}
              <span class="text-success">{{ event.vagas_disponiveis }} vagas disponíveis</span>
              {% else %}
              <span class="text-danger">Esgotado</span>
              {% endif %}
            </small>
          </div>
          <a href="{% url 'events:event_detail' event.pk %}" class="btn btn-primary mt-auto"> <i class="bi bi-eye"></i> Ver Detalhes </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Paginação -->
  {% if events.has_other_pages %}
  <nav aria-label="Navegação de página">
    <ul class="pagination justify-content-center">
      {% if events.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ events.previous_page_number }}">Anterior</a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">Anterior</span>
      </li>
      {% endif %} {% for num in events.paginator.page_range %} {% if events.number == num %}
      <li class="page-item active">
        <span class="page-link">{{ num }}</span>
      </li>
      {% elif num > events.number|add:'-3' and num < events.number|add:'3' %}
      <li class="page-item">
        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
      </li>
      {% endif %} {% endfor %} {% if events.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ events.next_page_number }}">Próximo</a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">Próximo</span>
      </li>
      {% endif %}
    </ul>
  </nav>
  {% endif %} {% else %}
  <div class="alert alert-info text-center"><i class="bi bi-info-circle"></i> Nenhum evento encontrado.</div>
  {% endif %}
</div>
{% endblock %}
