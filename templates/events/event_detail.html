{% extends 'base.html' %} {% block title %}{{ event.titulo }} - SGEA{% endblock %} {% block content %}
<div class="container mt-4 mb-5">
  <div class="row">
    <div class="col-lg-8">
      <div class="card mb-4">
        {% if event.imagem %}
        <img src="{{ event.imagem.url }}" class="card-img-top" alt="{{ event.titulo }}" style="max-height: 400px; object-fit: cover" />
        {% endif %}
        <div class="card-body">
          <h1 class="card-title">{{ event.titulo }}</h1>
          <p class="text-muted">
            <span class="badge bg-secondary">{{ event.get_tipo_evento_display }}</span>
            {% if not event.ativo %}
            <span class="badge bg-danger">Inativo</span>
            {% endif %} {% if event.is_passado %}
            <span class="badge bg-warning text-dark">Evento Encerrado</span>
            {% elif event.is_em_andamento %}
            <span class="badge bg-success">Em Andamento</span>
            {% endif %}
          </p>

          <hr />

          <h5><i class="bi bi-info-circle"></i> Descrição</h5>
          <p class="card-text">{{ event.descricao }}</p>

          <hr />

          <h5><i class="bi bi-calendar-event"></i> Informações do Evento</h5>
          <div class="row">
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-calendar"></i> Data de Início:</strong><br />
                {{ event.data_inicio|date:"d/m/Y" }}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-calendar"></i> Data de Término:</strong><br />
                {{ event.data_fim|date:"d/m/Y" }}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-clock"></i> Horário:</strong><br />
                {{ event.horario_inicio }} às {{ event.horario_fim }}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-geo-alt"></i> Local:</strong><br />
                {{ event.local }}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-people"></i> Vagas Disponíveis:</strong><br />
                {% if event.vagas_disponiveis > 0 %}
                <span class="text-success">{{ event.vagas_disponiveis }} de {{ event.vagas }}</span>
                {% else %}
                <span class="text-danger">Esgotado ({{ event.vagas }} vagas)</span>
                {% endif %}
              </p>
            </div>
            <div class="col-md-6 mb-3">
              <p>
                <strong><i class="bi bi-person"></i> Organizador:</strong><br />
                {{ event.organizador.get_full_name }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card mb-4">
        <div class="card-header"><i class="bi bi-check-circle"></i> Ações</div>
        <div class="card-body">
          {% if user.is_authenticated %} {% if is_organizador %}
          <a href="{% url 'events:event_update' event.pk %}" class="btn btn-warning w-100 mb-2"> <i class="bi bi-pencil"></i> Editar Evento </a>
          <a href="{% url 'events:event_inscriptions' event.pk %}" class="btn btn-info w-100 mb-2"> <i class="bi bi-people"></i> Ver Inscritos </a>
          <a href="{% url 'events:event_delete' event.pk %}" class="btn btn-danger w-100"> <i class="bi bi-trash"></i> Excluir Evento </a>
          {% elif is_inscrito %}
          <div class="alert alert-success"><i class="bi bi-check-circle"></i> Você está inscrito!</div>
          <a href="{% url 'events:inscription_cancel' inscricao.pk %}" class="btn btn-danger w-100"> <i class="bi bi-x-circle"></i> Cancelar Inscrição </a>
          {% else %} {% if event.tem_vagas and event.ativo and not event.is_passado %}
          <a href="{% url 'events:inscription_create' event.pk %}" class="btn btn-success w-100"> <i class="bi bi-check-circle"></i> Inscrever-se </a>
          {% else %} {% if not event.tem_vagas %}
          <div class="alert alert-danger"><i class="bi bi-x-circle"></i> Sem vagas disponíveis</div>
          {% elif not event.ativo %}
          <div class="alert alert-warning"><i class="bi bi-exclamation-triangle"></i> Inscrições encerradas</div>
          {% elif event.is_passado %}
          <div class="alert alert-info"><i class="bi bi-info-circle"></i> Evento encerrado</div>
          {% endif %} {% endif %} {% endif %} {% else %}
          <div class="alert alert-info"><i class="bi bi-info-circle"></i> Faça login para se inscrever</div>
          <a href="{% url 'users:login' %}?next={{ request.path }}" class="btn btn-primary w-100"> <i class="bi bi-box-arrow-in-right"></i> Fazer Login </a>
          {% endif %}
        </div>
      </div>

      <div class="card">
        <div class="card-header"><i class="bi bi-info-circle"></i> Estatísticas</div>
        <div class="card-body">
          <p><strong>Inscritos:</strong> {{ event.get_inscritos_count }}</p>
          <p>
            <strong>Taxa de Ocupação:</strong>
            {% widthratio event.get_inscritos_count event.vagas 100 %}%
          </p>
          <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: {% widthratio event.get_inscritos_count event.vagas 100 %}%" aria-valuenow="{% widthratio event.get_inscritos_count event.vagas 100 %}" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
